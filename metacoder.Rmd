---
title: "R Notebook"
output:
  html_document:
    df_print: paged
---
# From 
`https://grunwaldlab.github.io/metacoder_documentation/example.html`
```{r}
# install dev version of metacoder
install.packages("metacoder")
library(metacoder)
library(phyloseq)
library(ggtree)
```
```{r}
tree <- read.tree("data/tree.nwk")
tree

inc_phy <- readRDS("data/RDS/incubation_physeq_Aug18.RDS")

# Add the tree file to the phyloseq object
inc_phy <- merge_phyloseq(inc_phy, tree)
inc_phy
```
```{r}
nounclass <- subset_taxa(inc_phy, Phylum != "Bacteria_unclassified")

topotus <- names(sort(taxa_sums(nounclass), TRUE)[1:25])

inc_top <- phyloseq::prune_taxa(topotus, inc_phy) %>%
  phyloseq::filter_taxa(function(x) sum(x) >= 1, T) %>% 
  tax_glom(taxrank = "Genus")
  
tax_table(inc_top)
parsed_inc <- parse_phyloseq(inc_top)
parsed_inc
heat_tree(parsed_inc,
          node_size = n_obs,
          node_color = n_obs,
          node_label = taxon_names,
          tree_label = taxon_names)
```

